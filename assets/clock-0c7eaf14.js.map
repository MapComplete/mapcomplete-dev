{"version":3,"file":"clock-0c7eaf14.js","sources":["../../src/assets/generated/metatagging/clock.ts","../../index_clock.ts"],"sourcesContent":["import {Feature} from 'geojson'\nimport { ExtraFuncType } from \"../../../Logic/ExtraFunctions\";\nimport { Utils } from \"../../../Utils\"\nexport class ThemeMetaTagging {\n   public static readonly themeName = \"clock\"\n\n   public metaTaggging_for_walls_and_buildings(feat: Feature, helperFunctions: Record<ExtraFuncType, (feature: Feature) => Function>) {\n      const {distanceTo, overlapWith, enclosingFeatures, intersectionsWith, closest, closestn, get} = helperFunctions\n      Utils.AddLazyProperty(feat.properties, '_entrance_properties', () => overlapWith(feat)('entrance')?.map(e => e.feat.properties)?.filter(p => p !== undefined && p.indoor !== 'door') ) \n      Utils.AddLazyProperty(feat.properties, '_entrance_properties_with_width', () => get(feat)('_entrance_properties')?.filter(p => p['width'] !== undefined) ) \n      Utils.AddLazyProperty(feat.properties, '_entrances_count', () => get(feat)('_entrance_properties').length ) \n      Utils.AddLazyProperty(feat.properties, '_entrances_count_without_width_count', () =>  get(feat)('_entrances_count') - get(feat)('_entrance_properties_with_width').length ) \n      Utils.AddLazyProperty(feat.properties, '_biggest_width', () =>  Math.max( get(feat)('_entrance_properties').map(p => p.width)) ) \n      Utils.AddLazyProperty(feat.properties, '_biggest_width_properties', () =>  /* Can be a list! */ get(feat)('_entrance_properties').filter(p => p.width === get(feat)('_biggest_width')) ) \n      Utils.AddLazyProperty(feat.properties, '_biggest_width_id', () => get(feat)('_biggest_width_properties').id ) \n   }\n   public metaTaggging_for_clock(feat: Feature, helperFunctions: Record<ExtraFuncType, (feature: Feature) => Function>) {\n      const {distanceTo, overlapWith, enclosingFeatures, intersectionsWith, closest, closestn, get} = helperFunctions\n   }\n   public metaTaggging_for_note_import_clock(feat: Feature, helperFunctions: Record<ExtraFuncType, (feature: Feature) => Function>) {\n      const {distanceTo, overlapWith, enclosingFeatures, intersectionsWith, closest, closestn, get} = helperFunctions\n      Utils.AddLazyProperty(feat.properties, '_first_comment', () => get(feat)('comments')[0].text.toLowerCase() ) \n      Utils.AddLazyProperty(feat.properties, '_trigger_index', () => (() => {const lines = feat.properties['_first_comment'].split('\\n'); const matchesMapCompleteURL = lines.map(l => l.match(\".*https://mapcomplete.\\(org|osm.be\\)/\\([a-zA-Z_-]+\\)\\(.html\\)?.*#import\")); const matchedIndexes = matchesMapCompleteURL.map((doesMatch, i) => [doesMatch !== null, i]).filter(v => v[0]).map(v => v[1]); return matchedIndexes[0] })() ) \n      Utils.AddLazyProperty(feat.properties, '_comments_count', () => get(feat)('comments').length ) \n      Utils.AddLazyProperty(feat.properties, '_intro', () => (() => {const lines = get(feat)('comments')[0].text.split('\\n'); lines.splice(get(feat)('_trigger_index')-1, lines.length); return lines.filter(l => l !== '').join('<br/>');})() ) \n      Utils.AddLazyProperty(feat.properties, '_tags', () => (() => {let lines = get(feat)('comments')[0].text.split('\\n').map(l => l.trim()); lines.splice(0, get(feat)('_trigger_index') + 1); lines = lines.filter(l => l != ''); return lines.join(';');})() ) \n   }\n}","import layout from \"./src/assets/generated/themes/clock.json\"\nimport { ThemeMetaTagging } from \"./src/assets/generated/metatagging/clock\"\nimport selected_element from \"./src/assets/generated/layers/selected_element.json\"\nimport gps_location from \"./src/assets/generated/layers/gps_location.json\"\nimport gps_location_history from \"./src/assets/generated/layers/gps_location_history.json\"\nimport home_location from \"./src/assets/generated/layers/home_location.json\"\nimport gps_track from \"./src/assets/generated/layers/gps_track.json\"\nimport range from \"./src/assets/generated/layers/range.json\"\nimport last_click from \"./src/assets/generated/layers/last_click.json\"\nimport favourite from \"./src/assets/generated/layers/favourite.json\"\nimport ThemeViewState from \"./src/Models/ThemeViewState\"\nimport SvelteUIElement from \"./src/UI/Base/SvelteUIElement\"\nimport ThemeViewGUI from \"./src/UI/ThemeViewGUI.svelte\"\nimport LayoutConfig from \"./src/Models/ThemeConfig/LayoutConfig\";\nimport MetaTagging from \"./src/Logic/MetaTagging\";\nimport { FixedUiElement } from \"./src/UI/Base/FixedUiElement\";\n\nfunction webgl_support() {\n    try {\n        var canvas = document.createElement(\"canvas\")\n        return (\n            !!window.WebGLRenderingContext &&\n            (canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\"))\n        )\n    } catch (e) {\n        return false\n    }\n}\n\nif (!webgl_support()) {\n     new FixedUiElement(\"WebGL is not supported or not enabled. This is essential for MapComplete to function, please enable this.\").SetClass(\"block alert\").AttachTo(\"maindiv\")\n}else{\n    MetaTagging.setThemeMetatagging(new ThemeMetaTagging())\n    layout.layers.push(<any> selected_element)\n    layout.layers.push(<any> gps_location)\n    layout.layers.push(<any> gps_location_history)\n    layout.layers.push(<any> home_location)\n    layout.layers.push(<any> gps_track)\n    layout.layers.push(<any> range)\n    layout.layers.push(<any> last_click)\n    layout.layers.push(<any> favourite)\n    const state = new ThemeViewState(new LayoutConfig(<any> layout))\n    const main = new SvelteUIElement(ThemeViewGUI, { state })\n    main.AttachTo(\"maindiv\")\n}    \n"],"names":["ThemeMetaTagging","feat","helperFunctions","distanceTo","overlapWith","enclosingFeatures","intersectionsWith","closest","closestn","get","Utils","_b","_a","e","p","doesMatch","i","v","lines","l","__publicField","webgl_support","canvas","FixedUiElement","MetaTagging","layout","selected_element","gps_location","gps_location_history","home_location","gps_track","range","last_click","favourite","state","ThemeViewState","LayoutConfig","SvelteUIElement","ThemeViewGUI"],"mappings":"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"}