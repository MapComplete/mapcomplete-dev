var X=Object.defineProperty;var Y=(n,e,t)=>e in n?X(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var I=(n,e,t)=>(Y(n,typeof e!="symbol"?e+"":e,t),t);import{S as J,i as K,s as Q,A as V,d as B,t as C,C as Z,g as N,D as x,h as P,E as S,e as k,R as _,a as A,c as F,b as G,f as o,m as O,T as y,j as R,n as U}from"./Svg-d0210ccb.js";import{U as T,I as W}from"./LocalStorageSource-046df3bc.js";import{T as $,a as ee}from"./Tr-276f2bf3.js";import{G as te}from"./GeoOperations-850bc673.js";import{I as ae}from"./If-175efd55.js";const L=class L{constructor(){I(this,"gotMeasurement",new T(!1));I(this,"alpha",new T(void 0));I(this,"beta",new T(void 0));I(this,"gamma",new T(void 0));I(this,"absolute",new T(void 0));I(this,"arrowDirection",new T(void 0));I(this,"_measurementsStarted",!1)}fakeMeasurements(){this.alpha.setData(45),this.beta.setData(20),this.gamma.setData(30),this.absolute.setData(!0),this.gotMeasurement.setData(!0)}startMeasurements(){if(!this._measurementsStarted){this._measurementsStarted=!0,console.log("Starting device orientation listener");try{window.addEventListener("deviceorientationabsolute",e=>this.update(e))}catch(e){console.log("Could not init device orientation api due to",e)}}}update(e){this.gotMeasurement.setData(!0),this.alpha.setData(Math.floor(360-e.alpha)),this.beta.setData(Math.floor(e.beta)),this.gamma.setData(Math.floor(e.gamma)),this.absolute.setData(e.absolute),this.beta.data<0?this.arrowDirection.setData(this.gamma.data+180):this.arrowDirection.setData(-this.gamma.data)}};I(L,"singleton",new L);let j=L;function z(n){var M;let e,t,a,s,l,p,h,m,v,g,c,f,r,i;return c=new $({props:{t:ee.t.validation.slope.inputExplanation}}),r=new ae({props:{condition:((M=n[0])==null?void 0:M.featureSwitchIsTesting)??new W(!0),$$slots:{default:[le]},$$scope:{ctx:n}}}),{c(){e=k("div"),t=k("div"),a=k("div"),s=k("div"),l=_(n[3]),p=A(),h=k("div"),m=_(n[4]),v=A(),g=k("div"),F(c.$$.fragment),f=A(),F(r.$$.fragment),G(a,"class","font-bold w-full flex justify-around items-center text-5xl"),G(t,"class","flex w-full"),G(e,"class","flex flex-col m-2")},m(d,D){B(d,e,D),o(e,t),o(t,a),o(a,s),o(s,l),o(a,p),o(a,h),o(h,m),o(e,v),o(e,g),O(c,g,null),o(e,f),O(r,e,null),i=!0},p(d,D){var w;(!i||D&8)&&y(l,d[3]),(!i||D&16)&&y(m,d[4]);const b={};D&1&&(b.condition=((w=d[0])==null?void 0:w.featureSwitchIsTesting)??new W(!0)),D&131170&&(b.$$scope={dirty:D,ctx:d}),r.$set(b)},i(d){i||(C(c.$$.fragment,d),C(r.$$.fragment,d),i=!0)},o(d){N(c.$$.fragment,d),N(r.$$.fragment,d),i=!1},d(d){d&&P(e),R(c),R(r)}}}function ne(n){let e;return{c(){e=_("Backward")},m(t,a){B(t,e,a)},d(t){t&&P(e)}}}function se(n){let e;return{c(){e=_("Forward")},m(t,a){B(t,e,a)},d(t){t&&P(e)}}}function le(n){let e,t,a,s,l,p,h=n[1]-n[5]+"",m,v;function g(r,i){return r[6]===1?se:ne}let c=g(n),f=c(n);return{c(){e=k("span"),t=_("Way: "),a=_(n[1]),s=_("째, compass: "),l=_(n[5]),p=_("째, diff: "),m=_(h),v=A(),f.c(),G(e,"class","subtle")},m(r,i){B(r,e,i),o(e,t),o(e,a),o(e,s),o(e,l),o(e,p),o(e,m),o(e,v),f.m(e,null)},p(r,i){i&2&&y(a,r[1]),i&32&&y(l,r[5]),i&34&&h!==(h=r[1]-r[5]+"")&&y(m,h),c!==(c=g(r))&&(f.d(1),f=c(r),f&&(f.c(),f.m(e,null)))},d(r){r&&P(e),f.d()}}}function oe(n){let e,t,a=n[2]&&z(n);return{c(){a&&a.c(),e=V()},m(s,l){a&&a.m(s,l),B(s,e,l),t=!0},p(s,[l]){s[2]?a?(a.p(s,l),l&4&&C(a,1)):(a=z(s),a.c(),C(a,1),a.m(e.parentNode,e)):a&&(Z(),N(a,1,1,()=>{a=null}),x())},i(s){t||(C(a),t=!0)},o(s){N(a),t=!1},d(s){a&&a.d(s),s&&P(e)}}}function H(n){const e=Math.tan(n*Math.PI/180)*100;return Math.round(e/2.5)*2.5+"%"}function re(n,e,t){var q;let a,s,l,p,h,{value:m=new T(void 0)}=e,{mode:v="percentage"}=e,{feature:g=void 0}=e,{state:c=void 0}=e,f=45;((q=g==null?void 0:g.geometry)==null?void 0:q.type)==="LineString"&&(f=Math.round(te.bearing(g.geometry.coordinates[0],g.geometry.coordinates.at(-1))));let r=new T(void 0);S(n,r,u=>t(3,s=u));let i=new T(void 0);S(n,i,u=>t(4,l=u));const M=j.singleton;M.startMeasurements();const d=M.alpha;S(n,d,u=>t(5,p=u));const D=M.beta;let b=M.gotMeasurement;S(n,b,u=>t(2,a=u));let w=d.map(u=>{if(f===void 0)return 1;f<0&&t(1,f+=360);let E=Math.abs(f-u)%360;return E<90||E>270?1:-1});return S(n,w,u=>t(6,h=u)),D.map(u=>{let E=w.data;v==="degrees"?m.setData(E*u+"째"):m.setData(H(E*u)),r.setData(u+"째"),i.setData(H(u))},[w,D]),n.$$set=u=>{"value"in u&&t(12,m=u.value),"mode"in u&&t(13,v=u.mode),"feature"in u&&t(14,g=u.feature),"state"in u&&t(0,c=u.state)},[c,f,a,s,l,p,h,r,i,d,b,w,m,v,g]}class be extends J{constructor(e){super(),K(this,e,re,oe,Q,{value:12,mode:13,feature:14,state:0})}}function ie(n){let e,t,a,s,l,p,h,m,v,g,c,f,r,i,M,d,D;return{c(){e=_(`Device orientation data:
  `),t=k("ol"),a=k("li"),s=_("Alpha: "),l=_(n[1]),p=A(),h=k("li"),m=_("Beta: "),v=_(n[2]),g=A(),c=k("li"),f=_("Gamma: "),r=_(n[3]),i=A(),M=k("li"),d=_("Absolute?: "),D=_(n[4])},m(b,w){B(b,e,w),B(b,t,w),o(t,a),o(a,s),o(a,l),o(t,p),o(t,h),o(h,m),o(h,v),o(t,g),o(t,c),o(c,f),o(c,r),o(t,i),o(t,M),o(M,d),o(M,D)},p(b,w){w&2&&y(l,b[1]),w&4&&y(v,b[2]),w&8&&y(r,b[3]),w&16&&y(D,b[4])},d(b){b&&P(e),b&&P(t)}}}function ue(n){let e;return{c(){e=_("No device orientation data available")},m(t,a){B(t,e,a)},p:U,d(t){t&&P(e)}}}function fe(n){let e;function t(l,p){return l[0]?ie:ue}let a=t(n),s=a(n);return{c(){s.c(),e=V()},m(l,p){s.m(l,p),B(l,e,p)},p(l,[p]){a===(a=t(l))&&s?s.p(l,p):(s.d(1),s=a(l),s&&(s.c(),s.m(e.parentNode,e)))},i:U,o:U,d(l){s.d(l),l&&P(e)}}}function me(n,e,t){let a,s,l,p,h;const m=j.singleton;let v=m.alpha;S(n,v,i=>t(1,s=i));let g=m.beta;S(n,g,i=>t(2,l=i));let c=m.gamma;S(n,c,i=>t(3,p=i));let f=m.absolute;S(n,f,i=>t(4,h=i));let r=m.gotMeasurement;return S(n,r,i=>t(0,a=i)),m.startMeasurements(),[a,s,l,p,h,v,g,c,f,r]}class ve extends J{constructor(e){super(),K(this,e,me,fe,Q,{})}}export{j as O,be as S,ve as a};
