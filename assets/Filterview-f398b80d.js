import{S as A,i as R,s as j,x as se,e as D,X as re,d as p,Y as O,y as fe,z as ae,A as ue,C as ce,t as c,g as m,h as g,Z as _e,r as b,u as $,Q as J,p as te,v as le,l as C,R as q,T as N,n as T,c as k,a as L,b as F,m as v,f as S,j as w,N as me,o as de}from"./Svg-8b70b5dd.js";import{U as pe}from"./Utils-48ded42e.js";import{L as ge,T as he}from"./Translation-948f2d07.js";import"./PointRenderingConfig-f15314e4.js";import{U as be,I as P}from"./LocalStorageSource-5c82bae4.js";import"./FixImages-63693c6c.js";import"./Constants-88f0c761.js";import{T as ne}from"./ToSvelte-065dc30c.js";import{F as $e,V as ke,C as ie,I as ve}from"./If-82a566a9.js";import{T as we}from"./Tr-c35edf8f.js";function ye(r){let e,n,t,l;const f=r[3].default,i=se(f,r,r[2],null);return{c(){e=D("select"),i&&i.c(),r[0]===void 0&&re(()=>r[4].call(e))},m(s,o){p(s,e,o),i&&i.m(e,null),O(e,r[0],!0),n=!0,t||(l=fe(e,"change",r[4]),t=!0)},p(s,[o]){i&&i.p&&(!n||o&4)&&ae(i,f,s,s[2],n?ce(f,s[2],o,null):ue(s[2]),null),o&1&&O(e,s[0])},i(s){n||(c(i,s),n=!0)},o(s){m(i,s),n=!1},d(s){s&&g(e),i&&i.d(s),t=!1,l()}}}function Le(r,e,n){let{$$slots:t={},$$scope:l}=e,{value:f}=e,i=f.data;function s(){i=_e(this),n(0,i)}return r.$$set=o=>{"value"in o&&n(1,f=o.value),"$$scope"in o&&n(2,l=o.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&f.setData(i)},[i,f,l,t,s]}class De extends A{constructor(e){super(),R(this,e,Le,ye,j,{value:1})}}function Q(r,e,n){const t=r.slice();return t[11]=e[n],t[13]=n,t}function Se(r){let e=r[11].message+"",n;return{c(){n=q(e)},m(t,l){p(t,n,l)},p(t,l){l&1&&e!==(e=t[11].message+"")&&N(n,e)},i:T,o:T,d(t){t&&g(n)}}}function ze(r){let e,n,t,l;return n=new ke({props:{value:r[1][r[11].subs],type:r[2][r[11].subs]}}),{c(){e=D("span"),k(n.$$.fragment),t=L(),F(e,"class","mx-1")},m(f,i){p(f,e,i),v(n,e,null),S(e,t),l=!0},p(f,i){const s={};i&3&&(s.value=f[1][f[11].subs]),i&5&&(s.type=f[2][f[11].subs]),n.$set(s)},i(f){l||(c(n.$$.fragment,f),l=!0)},o(f){m(n.$$.fragment,f),l=!1},d(f){f&&g(e),w(n)}}}function W(r){let e,n,t,l;const f=[ze,Se],i=[];function s(o,a){return o[11].subs?0:1}return e=s(r),n=i[e]=f[e](r),{c(){n.c(),t=C()},m(o,a){i[e].m(o,a),p(o,t,a),l=!0},p(o,a){let u=e;e=s(o),e===u?i[e].p(o,a):(b(),m(i[u],1,1,()=>{i[u]=null}),$(),n=i[e],n?n.p(o,a):(n=i[e]=f[e](o),n.c()),c(n,1),n.m(t.parentNode,t))},i(o){l||(c(n),l=!0)},o(o){m(n),l=!1},d(o){i[e].d(o),o&&g(t)}}}function Te(r){let e,n,t=r[0],l=[];for(let i=0;i<t.length;i+=1)l[i]=W(Q(r,t,i));const f=i=>m(l[i],1,1,()=>{l[i]=null});return{c(){e=D("div");for(let i=0;i<l.length;i+=1)l[i].c()},m(i,s){p(i,e,s);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null);n=!0},p(i,[s]){if(s&7){t=i[0];let o;for(o=0;o<t.length;o+=1){const a=Q(i,t,o);l[o]?(l[o].p(a,s),c(l[o],1)):(l[o]=W(a),l[o].c(),c(l[o],1),l[o].m(e,null))}for(b(),o=t.length;o<l.length;o+=1)f(o);$()}},i(i){if(!n){for(let s=0;s<t.length;s+=1)c(l[s]);n=!0}},o(i){l=l.filter(Boolean);for(let s=0;s<l.length;s+=1)m(l[s]);n=!1},d(i){i&&g(e),J(l,i)}}}function Fe(r,e,n){let t,{filteredLayer:l}=e,{option:f}=e,{id:i}=e,s,o=ge.language;te(r,o,_=>n(7,t=_));let a={},u={},h=l.appliedFilters.get(i),U=JSON.parse((h==null?void 0:h.data)??"{}");function B(){const _={};for(const y in a){const I=a[y].data;I===void 0?_[y]=void 0:_[y]=I}h==null||h.setData($e.fieldsToString(_))}for(const _ of f.fields){const y=new be(U[_.name]??"");u[_.name]=_.type,a[_.name]=y,le(y.stabilized(200).addCallback(()=>{B()}))}return r.$$set=_=>{"filteredLayer"in _&&n(4,l=_.filteredLayer),"option"in _&&n(5,f=_.option),"id"in _&&n(6,i=_.id)},r.$$.update=()=>{if(r.$$.dirty&160){const _=f.question.textFor(t);n(0,s=pe.splitIntoSubstitutionParts(_))}},[s,a,u,o,l,f,i,t]}class Ie extends A{constructor(e){super(),R(this,e,Fe,Te,j,{filteredLayer:4,option:5,id:6})}}function X(r,e,n){const t=r.slice();return t[13]=e[n],t}function Y(r,e,n){const t=r.slice();return t[16]=e[n],t[18]=n,t}function Z(r){var i;let e,n,t,l;n=new ie({props:{selected:r[6],$$slots:{default:[Ne]},$$scope:{ctx:r}}});let f=r[4]&&((i=r[0].layerDef.filters)==null?void 0:i.length)>0&&H(r);return{c(){e=D("div"),k(n.$$.fragment),t=L(),f&&f.c(),F(e,"class","mb-1.5")},m(s,o){p(s,e,o),v(n,e,null),S(e,t),f&&f.m(e,null),r[12](e),l=!0},p(s,o){var u;const a={};o&524297&&(a.$$scope={dirty:o,ctx:s}),n.$set(a),s[4]&&((u=s[0].layerDef.filters)==null?void 0:u.length)>0?f?(f.p(s,o),o&17&&c(f,1)):(f=H(s),f.c(),c(f,1),f.m(e,null)):f&&(b(),m(f,1,1,()=>{f=null}),$())},i(s){l||(c(n.$$.fragment,s),c(f),l=!0)},o(s){m(n.$$.fragment,s),m(f),l=!1},d(s){s&&g(e),w(n),f&&f.d(),r[12](null)}}}function Ce(r){let e,n;return e=new ne({props:{construct:r[11]}}),{c(){k(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p:T,i(t){n||(c(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function qe(r){let e,n;return e=new ne({props:{slot:"else",construct:r[10]}}),{c(){k(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p:T,i(t){n||(c(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function G(r){let e,n,t;return n=new we({props:{t:he.t.general.layerSelection.zoomInToSeeThisLayer}}),{c(){e=D("span"),k(n.$$.fragment),F(e,"class","alert")},m(l,f){p(l,e,f),v(n,e,null),t=!0},p:T,i(l){t||(c(n.$$.fragment,l),t=!0)},o(l){m(n.$$.fragment,l),t=!1},d(l){l&&g(e),w(n)}}}function Ne(r){let e,n,t=r[0].layerDef.name+"",l,f,i,s;e=new ve({props:{condition:r[0].isDisplayed,$$slots:{else:[qe],default:[Ce]},$$scope:{ctx:r}}});let o=r[3]<r[5].minzoom&&G();return{c(){k(e.$$.fragment),n=L(),l=q(t),f=L(),o&&o.c(),i=C()},m(a,u){v(e,a,u),p(a,n,u),p(a,l,u),p(a,f,u),o&&o.m(a,u),p(a,i,u),s=!0},p(a,u){const h={};u&1&&(h.condition=a[0].isDisplayed),u&524288&&(h.$$scope={dirty:u,ctx:a}),e.$set(h),(!s||u&1)&&t!==(t=a[0].layerDef.name+"")&&N(l,t),a[3]<a[5].minzoom?o?(o.p(a,u),u&8&&c(o,1)):(o=G(),o.c(),c(o,1),o.m(i.parentNode,i)):o&&(b(),m(o,1,1,()=>{o=null}),$())},i(a){s||(c(e.$$.fragment,a),c(o),s=!0)},o(a){m(e.$$.fragment,a),m(o),s=!1},d(a){w(e,a),a&&g(n),a&&g(l),a&&g(f),o&&o.d(a),a&&g(i)}}}function H(r){let e,n,t=r[0].layerDef.filters,l=[];for(let i=0;i<t.length;i+=1)l[i]=ee(X(r,t,i));const f=i=>m(l[i],1,1,()=>{l[i]=null});return{c(){e=D("div");for(let i=0;i<l.length;i+=1)l[i].c();F(e,"id","subfilters"),F(e,"class","ml-4 flex flex-col gap-y-1")},m(i,s){p(i,e,s);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null);n=!0},p(i,s){if(s&385){t=i[0].layerDef.filters;let o;for(o=0;o<t.length;o+=1){const a=X(i,t,o);l[o]?(l[o].p(a,s),c(l[o],1)):(l[o]=ee(a),l[o].c(),c(l[o],1),l[o].m(e,null))}for(b(),o=t.length;o<l.length;o+=1)f(o);$()}},i(i){if(!n){for(let s=0;s<t.length;s+=1)c(l[s]);n=!0}},o(i){l=l.filter(Boolean);for(let s=0;s<l.length;s+=1)m(l[s]);n=!1},d(i){i&&g(e),J(l,i)}}}function K(r){let e,n;return e=new ie({props:{selected:r[7](r[13]),$$slots:{default:[Ue]},$$scope:{ctx:r}}}),{c(){k(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p(t,l){const f={};l&1&&(f.selected=t[7](t[13])),l&524289&&(f.$$scope={dirty:l,ctx:t}),e.$set(f)},i(t){n||(c(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Ue(r){let e=r[13].options[0].question+"",n;return{c(){n=q(e)},m(t,l){p(t,n,l)},p(t,l){l&1&&e!==(e=t[13].options[0].question+"")&&N(n,e)},d(t){t&&g(n)}}}function M(r){let e,n;return e=new Ie({props:{id:r[13].id,filteredLayer:r[0],option:r[13].options[0]}}),{c(){k(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p(t,l){const f={};l&1&&(f.id=t[13].id),l&1&&(f.filteredLayer=t[0]),l&1&&(f.option=t[13].options[0]),e.$set(f)},i(t){n||(c(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function E(r){let e,n;return e=new De({props:{value:r[8](r[13]),$$slots:{default:[Be]},$$scope:{ctx:r}}}),{c(){k(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p(t,l){const f={};l&1&&(f.value=t[8](t[13])),l&524289&&(f.$$scope={dirty:l,ctx:t}),e.$set(f)},i(t){n||(c(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function x(r){let e,n=r[16].question+"",t,l;return{c(){e=D("option"),t=q(n),l=L(),e.__value=r[18],e.value=e.__value},m(f,i){p(f,e,i),S(e,t),S(e,l)},p(f,i){i&1&&n!==(n=f[16].question+"")&&N(t,n)},d(f){f&&g(e)}}}function Be(r){let e,n=r[13].options,t=[];for(let l=0;l<n.length;l+=1)t[l]=x(Y(r,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=C()},m(l,f){for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(l,f);p(l,e,f)},p(l,f){if(f&1){n=l[13].options;let i;for(i=0;i<n.length;i+=1){const s=Y(l,n,i);t[i]?t[i].p(s,f):(t[i]=x(s),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=n.length}},d(l){J(t,l),l&&g(e)}}}function ee(r){let e,n,t,l,f,i=r[13].options.length===1&&r[13].options[0].fields.length===0&&K(r),s=r[13].options.length===1&&r[13].options[0].fields.length>0&&M(r),o=r[13].options.length>1&&E(r);return{c(){e=D("div"),i&&i.c(),n=L(),s&&s.c(),t=L(),o&&o.c(),l=L()},m(a,u){p(a,e,u),i&&i.m(e,null),S(e,n),s&&s.m(e,null),S(e,t),o&&o.m(e,null),S(e,l),f=!0},p(a,u){a[13].options.length===1&&a[13].options[0].fields.length===0?i?(i.p(a,u),u&1&&c(i,1)):(i=K(a),i.c(),c(i,1),i.m(e,n)):i&&(b(),m(i,1,1,()=>{i=null}),$()),a[13].options.length===1&&a[13].options[0].fields.length>0?s?(s.p(a,u),u&1&&c(s,1)):(s=M(a),s.c(),c(s,1),s.m(e,t)):s&&(b(),m(s,1,1,()=>{s=null}),$()),a[13].options.length>1?o?(o.p(a,u),u&1&&c(o,1)):(o=E(a),o.c(),c(o,1),o.m(e,l)):o&&(b(),m(o,1,1,()=>{o=null}),$())},i(a){f||(c(i),c(s),c(o),f=!0)},o(a){m(i),m(s),m(o),f=!1},d(a){a&&g(e),i&&i.d(),s&&s.d(),o&&o.d()}}}function Ve(r){let e,n,t=r[0].layerDef.name&&Z(r);return{c(){t&&t.c(),e=C()},m(l,f){t&&t.m(l,f),p(l,e,f),n=!0},p(l,[f]){l[0].layerDef.name?t?(t.p(l,f),f&1&&c(t,1)):(t=Z(l),t.c(),c(t,1),t.m(e.parentNode,e)):t&&(b(),m(t,1,1,()=>{t=null}),$())},i(l){n||(c(t),n=!0)},o(l){m(t),n=!1},d(l){t&&t.d(l),l&&g(e)}}}function Ae(r,e,n){let t,l=T,f=()=>(l(),l=me(a,d=>n(3,t=d)),a),i;r.$$.on_destroy.push(()=>l());let{filteredLayer:s}=e,{highlightedLayer:o=new P(void 0)}=e,{zoomlevel:a=new P(22)}=e;f();let u=s.layerDef,h=s.isDisplayed;te(r,h,d=>n(4,i=d));function U(d){return s.appliedFilters.get(d.id).sync(z=>z===0,[],z=>z?0:void 0)}function B(d){return s.appliedFilters.get(d.id)}let _;const y=()=>{var d;return(d=u.defaultIcon())==null?void 0:d.SetClass("block h-6 w-6 no-image-background opacity-50")},I=()=>{var d;return(d=u.defaultIcon())==null?void 0:d.SetClass("block h-6 w-6 no-image-background")};function oe(d){de[d?"unshift":"push"](()=>{_=d,n(2,_)})}return r.$$set=d=>{"filteredLayer"in d&&n(0,s=d.filteredLayer),"highlightedLayer"in d&&n(9,o=d.highlightedLayer),"zoomlevel"in d&&f(n(1,a=d.zoomlevel))},r.$$.update=()=>{r.$$.dirty&517&&le(o.addCallbackAndRun(d=>{var V,z;d===s.layerDef.id?(V=_==null?void 0:_.classList)==null||V.add("glowing-shadow"):(z=_==null?void 0:_.classList)==null||z.remove("glowing-shadow")}))},[s,a,_,t,i,u,h,U,B,o,y,I,oe]}class Ge extends A{constructor(e){super(),R(this,e,Ae,Ve,j,{filteredLayer:0,highlightedLayer:9,zoomlevel:1})}}export{Ge as F};
