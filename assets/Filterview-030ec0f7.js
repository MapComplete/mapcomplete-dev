import{S as Y,i as Z,s as E,e as L,d,t as u,A as v,C as w,g as c,h as g,T as V,D as x,P as ee,z as C,O as oe,U as ie,n as F,c as $,a as D,b as I,m as b,f as z,j as k,F as re,E as se}from"./index-c3a22d0a.js";import{U as fe}from"./Utils-e0968e8e.js";import{L as ae,T as q,a as ue}from"./tw-merge-467516b3.js";import"./FixImages-8566251b.js";import{U as ce,I as A}from"./UIEventSource-14eb915f.js";import"./Constants-25993438.js";import{F as me,V as _e,C as te,I as pe,T as le}from"./Checkbox-be96c579.js";import{D as de}from"./Dropdown-765f0b77.js";function O(f,e,o){const t=f.slice();return t[11]=e[o],t[13]=o,t}function ge(f){let e=f[11].message+"",o;return{c(){o=oe(e)},m(t,l){d(t,o,l)},p(t,l){l&1&&e!==(e=t[11].message+"")&&ie(o,e)},i:F,o:F,d(t){t&&g(o)}}}function he(f){let e,o,t,l;return o=new _e({props:{value:f[1][f[11].subs],type:f[2][f[11].subs]}}),{c(){e=L("span"),$(o.$$.fragment),t=D(),I(e,"class","mx-1")},m(s,i){d(s,e,i),b(o,e,null),z(e,t),l=!0},p(s,i){const r={};i&3&&(r.value=s[1][s[11].subs]),i&5&&(r.type=s[2][s[11].subs]),o.$set(r)},i(s){l||(u(o.$$.fragment,s),l=!0)},o(s){c(o.$$.fragment,s),l=!1},d(s){s&&g(e),k(o)}}}function P(f){let e,o,t,l;const s=[he,ge],i=[];function r(n,a){return n[11].subs?0:1}return e=r(f),o=i[e]=s[e](f),{c(){o.c(),t=C()},m(n,a){i[e].m(n,a),d(n,t,a),l=!0},p(n,a){let _=e;e=r(n),e===_?i[e].p(n,a):(v(),c(i[_],1,1,()=>{i[_]=null}),w(),o=i[e],o?o.p(n,a):(o=i[e]=s[e](n),o.c()),u(o,1),o.m(t.parentNode,t))},i(n){l||(u(o),l=!0)},o(n){c(o),l=!1},d(n){i[e].d(n),n&&g(t)}}}function $e(f){let e,o,t=f[0],l=[];for(let i=0;i<t.length;i+=1)l[i]=P(O(f,t,i));const s=i=>c(l[i],1,1,()=>{l[i]=null});return{c(){e=L("div");for(let i=0;i<l.length;i+=1)l[i].c()},m(i,r){d(i,e,r);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null);o=!0},p(i,[r]){if(r&7){t=i[0];let n;for(n=0;n<t.length;n+=1){const a=O(i,t,n);l[n]?(l[n].p(a,r),u(l[n],1)):(l[n]=P(a),l[n].c(),u(l[n],1),l[n].m(e,null))}for(v(),n=t.length;n<l.length;n+=1)s(n);w()}},i(i){if(!o){for(let r=0;r<t.length;r+=1)u(l[r]);o=!0}},o(i){l=l.filter(Boolean);for(let r=0;r<l.length;r+=1)c(l[r]);o=!1},d(i){i&&g(e),V(l,i)}}}function be(f,e,o){let t,{filteredLayer:l}=e,{option:s}=e,{id:i}=e,r,n=ae.language;x(f,n,m=>o(7,t=m));let a={},_={},h=l.appliedFilters.get(i),N=JSON.parse((h==null?void 0:h.data)??"{}");function U(){const m={};for(const y in a){const T=a[y].data;T===void 0?m[y]=void 0:m[y]=T}h==null||h.setData(me.fieldsToString(m))}for(const m of s.fields){const y=new ce(N[m.name]??"");_[m.name]=m.type,a[m.name]=y,ee(y.stabilized(200).addCallback(()=>{U()}))}return f.$$set=m=>{"filteredLayer"in m&&o(4,l=m.filteredLayer),"option"in m&&o(5,s=m.option),"id"in m&&o(6,i=m.id)},f.$$.update=()=>{if(f.$$.dirty&160){const m=s.question.textFor(t);o(0,r=fe.splitIntoSubstitutionParts(m))}},[r,a,_,n,l,s,i,t]}class ke extends Y{constructor(e){super(),Z(this,e,be,$e,E,{filteredLayer:4,option:5,id:6})}}function j(f,e,o){const t=f.slice();return t[13]=e[o],t}function J(f,e,o){const t=f.slice();return t[16]=e[o],t[18]=o,t}function R(f){var i;let e,o,t,l;o=new te({props:{selected:f[6],$$slots:{default:[ye]},$$scope:{ctx:f}}});let s=f[4]&&((i=f[0].layerDef.filters)==null?void 0:i.length)>0&&G(f);return{c(){e=L("div"),$(o.$$.fragment),t=D(),s&&s.c(),I(e,"class","mb-1.5")},m(r,n){d(r,e,n),b(o,e,null),z(e,t),s&&s.m(e,null),f[12](e),l=!0},p(r,n){var _;const a={};n&524297&&(a.$$scope={dirty:n,ctx:r}),o.$set(a),r[4]&&((_=r[0].layerDef.filters)==null?void 0:_.length)>0?s?(s.p(r,n),n&17&&u(s,1)):(s=G(r),s.c(),u(s,1),s.m(e,null)):s&&(v(),c(s,1,1,()=>{s=null}),w())},i(r){l||(u(o.$$.fragment,r),u(s),l=!0)},o(r){c(o.$$.fragment,r),c(s),l=!1},d(r){r&&g(e),k(o),s&&s.d(),f[12](null)}}}function ve(f){let e,o;return e=new le({props:{construct:f[11]}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p:F,i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function we(f){let e,o;return e=new le({props:{slot:"else",construct:f[10]}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p:F,i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function W(f){let e,o,t;return o=new q({props:{t:ue.t.general.layerSelection.zoomInToSeeThisLayer}}),{c(){e=L("span"),$(o.$$.fragment),I(e,"class","alert")},m(l,s){d(l,e,s),b(o,e,null),t=!0},p:F,i(l){t||(u(o.$$.fragment,l),t=!0)},o(l){c(o.$$.fragment,l),t=!1},d(l){l&&g(e),k(o)}}}function ye(f){let e,o,t,l,s,i;e=new pe({props:{condition:f[0].isDisplayed,$$slots:{else:[we],default:[ve]},$$scope:{ctx:f}}}),t=new q({props:{t:f[0].layerDef.name}});let r=f[3]<f[5].minzoom&&W();return{c(){$(e.$$.fragment),o=D(),$(t.$$.fragment),l=D(),r&&r.c(),s=C()},m(n,a){b(e,n,a),d(n,o,a),b(t,n,a),d(n,l,a),r&&r.m(n,a),d(n,s,a),i=!0},p(n,a){const _={};a&1&&(_.condition=n[0].isDisplayed),a&524288&&(_.$$scope={dirty:a,ctx:n}),e.$set(_);const h={};a&1&&(h.t=n[0].layerDef.name),t.$set(h),n[3]<n[5].minzoom?r?(r.p(n,a),a&8&&u(r,1)):(r=W(),r.c(),u(r,1),r.m(s.parentNode,s)):r&&(v(),c(r,1,1,()=>{r=null}),w())},i(n){i||(u(e.$$.fragment,n),u(t.$$.fragment,n),u(r),i=!0)},o(n){c(e.$$.fragment,n),c(t.$$.fragment,n),c(r),i=!1},d(n){k(e,n),n&&g(o),k(t,n),n&&g(l),r&&r.d(n),n&&g(s)}}}function G(f){let e,o,t=f[0].layerDef.filters,l=[];for(let i=0;i<t.length;i+=1)l[i]=X(j(f,t,i));const s=i=>c(l[i],1,1,()=>{l[i]=null});return{c(){e=L("div");for(let i=0;i<l.length;i+=1)l[i].c();I(e,"id","subfilters"),I(e,"class","ml-4 flex flex-col gap-y-1")},m(i,r){d(i,e,r);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null);o=!0},p(i,r){if(r&385){t=i[0].layerDef.filters;let n;for(n=0;n<t.length;n+=1){const a=j(i,t,n);l[n]?(l[n].p(a,r),u(l[n],1)):(l[n]=X(a),l[n].c(),u(l[n],1),l[n].m(e,null))}for(v(),n=t.length;n<l.length;n+=1)s(n);w()}},i(i){if(!o){for(let r=0;r<t.length;r+=1)u(l[r]);o=!0}},o(i){l=l.filter(Boolean);for(let r=0;r<l.length;r+=1)c(l[r]);o=!1},d(i){i&&g(e),V(l,i)}}}function H(f){let e,o;return e=new te({props:{selected:f[7](f[13]),$$slots:{default:[De]},$$scope:{ctx:f}}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p(t,l){const s={};l&1&&(s.selected=t[7](t[13])),l&524289&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function De(f){let e,o;return e=new q({props:{t:f[13].options[0].question}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p(t,l){const s={};l&1&&(s.t=t[13].options[0].question),e.$set(s)},i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function K(f){let e,o;return e=new ke({props:{id:f[13].id,filteredLayer:f[0],option:f[13].options[0]}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p(t,l){const s={};l&1&&(s.id=t[13].id),l&1&&(s.filteredLayer=t[0]),l&1&&(s.option=t[13].options[0]),e.$set(s)},i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function M(f){let e,o;return e=new de({props:{value:f[8](f[13]),$$slots:{default:[Le]},$$scope:{ctx:f}}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p(t,l){const s={};l&1&&(s.value=t[8](t[13])),l&524289&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function Q(f){let e,o,t,l;return o=new q({props:{t:f[16].question}}),{c(){e=L("option"),$(o.$$.fragment),t=D(),e.__value=f[18],e.value=e.__value},m(s,i){d(s,e,i),b(o,e,null),z(e,t),l=!0},p(s,i){const r={};i&1&&(r.t=s[16].question),o.$set(r)},i(s){l||(u(o.$$.fragment,s),l=!0)},o(s){c(o.$$.fragment,s),l=!1},d(s){s&&g(e),k(o)}}}function Le(f){let e,o,t=f[13].options,l=[];for(let i=0;i<t.length;i+=1)l[i]=Q(J(f,t,i));const s=i=>c(l[i],1,1,()=>{l[i]=null});return{c(){for(let i=0;i<l.length;i+=1)l[i].c();e=C()},m(i,r){for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(i,r);d(i,e,r),o=!0},p(i,r){if(r&1){t=i[13].options;let n;for(n=0;n<t.length;n+=1){const a=J(i,t,n);l[n]?(l[n].p(a,r),u(l[n],1)):(l[n]=Q(a),l[n].c(),u(l[n],1),l[n].m(e.parentNode,e))}for(v(),n=t.length;n<l.length;n+=1)s(n);w()}},i(i){if(!o){for(let r=0;r<t.length;r+=1)u(l[r]);o=!0}},o(i){l=l.filter(Boolean);for(let r=0;r<l.length;r+=1)c(l[r]);o=!1},d(i){V(l,i),i&&g(e)}}}function X(f){let e,o,t,l,s,i=f[13].options.length===1&&f[13].options[0].fields.length===0&&H(f),r=f[13].options.length===1&&f[13].options[0].fields.length>0&&K(f),n=f[13].options.length>1&&M(f);return{c(){e=L("div"),i&&i.c(),o=D(),r&&r.c(),t=D(),n&&n.c(),l=D()},m(a,_){d(a,e,_),i&&i.m(e,null),z(e,o),r&&r.m(e,null),z(e,t),n&&n.m(e,null),z(e,l),s=!0},p(a,_){a[13].options.length===1&&a[13].options[0].fields.length===0?i?(i.p(a,_),_&1&&u(i,1)):(i=H(a),i.c(),u(i,1),i.m(e,o)):i&&(v(),c(i,1,1,()=>{i=null}),w()),a[13].options.length===1&&a[13].options[0].fields.length>0?r?(r.p(a,_),_&1&&u(r,1)):(r=K(a),r.c(),u(r,1),r.m(e,t)):r&&(v(),c(r,1,1,()=>{r=null}),w()),a[13].options.length>1?n?(n.p(a,_),_&1&&u(n,1)):(n=M(a),n.c(),u(n,1),n.m(e,l)):n&&(v(),c(n,1,1,()=>{n=null}),w())},i(a){s||(u(i),u(r),u(n),s=!0)},o(a){c(i),c(r),c(n),s=!1},d(a){a&&g(e),i&&i.d(),r&&r.d(),n&&n.d()}}}function Se(f){let e,o,t=f[0].layerDef.name&&R(f);return{c(){t&&t.c(),e=C()},m(l,s){t&&t.m(l,s),d(l,e,s),o=!0},p(l,[s]){l[0].layerDef.name?t?(t.p(l,s),s&1&&u(t,1)):(t=R(l),t.c(),u(t,1),t.m(e.parentNode,e)):t&&(v(),c(t,1,1,()=>{t=null}),w())},i(l){o||(u(t),o=!0)},o(l){c(t),o=!1},d(l){t&&t.d(l),l&&g(e)}}}function ze(f,e,o){let t,l=F,s=()=>(l(),l=re(a,p=>o(3,t=p)),a),i;f.$$.on_destroy.push(()=>l());let{filteredLayer:r}=e,{highlightedLayer:n=new A(void 0)}=e,{zoomlevel:a=new A(22)}=e;s();let _=r.layerDef,h=r.isDisplayed;x(f,h,p=>o(4,i=p));function N(p){return r.appliedFilters.get(p.id).sync(S=>S===0,[],S=>S?0:void 0)}function U(p){return r.appliedFilters.get(p.id)}let m;const y=()=>{var p;return(p=_.defaultIcon())==null?void 0:p.SetClass("block h-6 w-6 no-image-background opacity-50")},T=()=>{var p;return(p=_.defaultIcon())==null?void 0:p.SetClass("block h-6 w-6 no-image-background")};function ne(p){se[p?"unshift":"push"](()=>{m=p,o(2,m)})}return f.$$set=p=>{"filteredLayer"in p&&o(0,r=p.filteredLayer),"highlightedLayer"in p&&o(9,n=p.highlightedLayer),"zoomlevel"in p&&s(o(1,a=p.zoomlevel))},f.$$.update=()=>{f.$$.dirty&517&&ee(n.addCallbackAndRun(p=>{var B,S;p===r.layerDef.id?(B=m==null?void 0:m.classList)==null||B.add("glowing-shadow"):(S=m==null?void 0:m.classList)==null||S.remove("glowing-shadow")}))},[r,a,m,t,i,_,h,N,U,n,y,T,ne]}class Ve extends Y{constructor(e){super(),Z(this,e,ze,Se,E,{filteredLayer:0,highlightedLayer:9,zoomlevel:1})}}export{Ve as F};
//# sourceMappingURL=Filterview-030ec0f7.js.map
