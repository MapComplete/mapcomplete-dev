import{S as Z,i as E,s as x,e as S,d,t as c,A as b,C as $,g as m,h as g,Q as A,D as ee,N as te,z as C,R as q,T as N,n as F,c as k,a as D,b as I,m as v,f as L,j as w,F as oe,E as re}from"./tw-merge-ef1cf9a3.js";import{U as se}from"./Utils-498bb79d.js";import{L as fe,T as ae,a as ue}from"./Tr-a8d7042b.js";import"./SubtleLink-a05ac2e4.js";import{U as ce,I as R}from"./LocalStorageSource-78a030c5.js";import"./Constants-85b2fbbb.js";import{F as _e,V as me,C as le,I as pe,T as ne}from"./Checkbox-90a823d3.js";import{D as de}from"./Dropdown-5808f614.js";function j(s,t,n){const e=s.slice();return e[11]=t[n],e[13]=n,e}function ge(s){let t=s[11].message+"",n;return{c(){n=q(t)},m(e,l){d(e,n,l)},p(e,l){l&1&&t!==(t=e[11].message+"")&&N(n,t)},i:F,o:F,d(e){e&&g(n)}}}function he(s){let t,n,e,l;return n=new me({props:{value:s[1][s[11].subs],type:s[2][s[11].subs]}}),{c(){t=S("span"),k(n.$$.fragment),e=D(),I(t,"class","mx-1")},m(r,i){d(r,t,i),v(n,t,null),L(t,e),l=!0},p(r,i){const f={};i&3&&(f.value=r[1][r[11].subs]),i&5&&(f.type=r[2][r[11].subs]),n.$set(f)},i(r){l||(c(n.$$.fragment,r),l=!0)},o(r){m(n.$$.fragment,r),l=!1},d(r){r&&g(t),w(n)}}}function J(s){let t,n,e,l;const r=[he,ge],i=[];function f(o,a){return o[11].subs?0:1}return t=f(s),n=i[t]=r[t](s),{c(){n.c(),e=C()},m(o,a){i[t].m(o,a),d(o,e,a),l=!0},p(o,a){let u=t;t=f(o),t===u?i[t].p(o,a):(b(),m(i[u],1,1,()=>{i[u]=null}),$(),n=i[t],n?n.p(o,a):(n=i[t]=r[t](o),n.c()),c(n,1),n.m(e.parentNode,e))},i(o){l||(c(n),l=!0)},o(o){m(n),l=!1},d(o){i[t].d(o),o&&g(e)}}}function be(s){let t,n,e=s[0],l=[];for(let i=0;i<e.length;i+=1)l[i]=J(j(s,e,i));const r=i=>m(l[i],1,1,()=>{l[i]=null});return{c(){t=S("div");for(let i=0;i<l.length;i+=1)l[i].c()},m(i,f){d(i,t,f);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(t,null);n=!0},p(i,[f]){if(f&7){e=i[0];let o;for(o=0;o<e.length;o+=1){const a=j(i,e,o);l[o]?(l[o].p(a,f),c(l[o],1)):(l[o]=J(a),l[o].c(),c(l[o],1),l[o].m(t,null))}for(b(),o=e.length;o<l.length;o+=1)r(o);$()}},i(i){if(!n){for(let f=0;f<e.length;f+=1)c(l[f]);n=!0}},o(i){l=l.filter(Boolean);for(let f=0;f<l.length;f+=1)m(l[f]);n=!1},d(i){i&&g(t),A(l,i)}}}function $e(s,t,n){let e,{filteredLayer:l}=t,{option:r}=t,{id:i}=t,f,o=fe.language;ee(s,o,_=>n(7,e=_));let a={},u={},h=l.appliedFilters.get(i),U=JSON.parse((h==null?void 0:h.data)??"{}");function B(){const _={};for(const y in a){const T=a[y].data;T===void 0?_[y]=void 0:_[y]=T}h==null||h.setData(_e.fieldsToString(_))}for(const _ of r.fields){const y=new ce(U[_.name]??"");u[_.name]=_.type,a[_.name]=y,te(y.stabilized(200).addCallback(()=>{B()}))}return s.$$set=_=>{"filteredLayer"in _&&n(4,l=_.filteredLayer),"option"in _&&n(5,r=_.option),"id"in _&&n(6,i=_.id)},s.$$.update=()=>{if(s.$$.dirty&160){const _=r.question.textFor(e);n(0,f=se.splitIntoSubstitutionParts(_))}},[f,a,u,o,l,r,i,e]}class ke extends Z{constructor(t){super(),E(this,t,$e,be,x,{filteredLayer:4,option:5,id:6})}}function O(s,t,n){const e=s.slice();return e[13]=t[n],e}function P(s,t,n){const e=s.slice();return e[16]=t[n],e[18]=n,e}function Q(s){var i;let t,n,e,l;n=new le({props:{selected:s[6],$$slots:{default:[ye]},$$scope:{ctx:s}}});let r=s[4]&&((i=s[0].layerDef.filters)==null?void 0:i.length)>0&&G(s);return{c(){t=S("div"),k(n.$$.fragment),e=D(),r&&r.c(),I(t,"class","mb-1.5")},m(f,o){d(f,t,o),v(n,t,null),L(t,e),r&&r.m(t,null),s[12](t),l=!0},p(f,o){var u;const a={};o&524297&&(a.$$scope={dirty:o,ctx:f}),n.$set(a),f[4]&&((u=f[0].layerDef.filters)==null?void 0:u.length)>0?r?(r.p(f,o),o&17&&c(r,1)):(r=G(f),r.c(),c(r,1),r.m(t,null)):r&&(b(),m(r,1,1,()=>{r=null}),$())},i(f){l||(c(n.$$.fragment,f),c(r),l=!0)},o(f){m(n.$$.fragment,f),m(r),l=!1},d(f){f&&g(t),w(n),r&&r.d(),s[12](null)}}}function ve(s){let t,n;return t=new ne({props:{construct:s[11]}}),{c(){k(t.$$.fragment)},m(e,l){v(t,e,l),n=!0},p:F,i(e){n||(c(t.$$.fragment,e),n=!0)},o(e){m(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function we(s){let t,n;return t=new ne({props:{slot:"else",construct:s[10]}}),{c(){k(t.$$.fragment)},m(e,l){v(t,e,l),n=!0},p:F,i(e){n||(c(t.$$.fragment,e),n=!0)},o(e){m(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function W(s){let t,n,e;return n=new ae({props:{t:ue.t.general.layerSelection.zoomInToSeeThisLayer}}),{c(){t=S("span"),k(n.$$.fragment),I(t,"class","alert")},m(l,r){d(l,t,r),v(n,t,null),e=!0},p:F,i(l){e||(c(n.$$.fragment,l),e=!0)},o(l){m(n.$$.fragment,l),e=!1},d(l){l&&g(t),w(n)}}}function ye(s){let t,n,e=s[0].layerDef.name+"",l,r,i,f;t=new pe({props:{condition:s[0].isDisplayed,$$slots:{else:[we],default:[ve]},$$scope:{ctx:s}}});let o=s[3]<s[5].minzoom&&W();return{c(){k(t.$$.fragment),n=D(),l=q(e),r=D(),o&&o.c(),i=C()},m(a,u){v(t,a,u),d(a,n,u),d(a,l,u),d(a,r,u),o&&o.m(a,u),d(a,i,u),f=!0},p(a,u){const h={};u&1&&(h.condition=a[0].isDisplayed),u&524288&&(h.$$scope={dirty:u,ctx:a}),t.$set(h),(!f||u&1)&&e!==(e=a[0].layerDef.name+"")&&N(l,e),a[3]<a[5].minzoom?o?(o.p(a,u),u&8&&c(o,1)):(o=W(),o.c(),c(o,1),o.m(i.parentNode,i)):o&&(b(),m(o,1,1,()=>{o=null}),$())},i(a){f||(c(t.$$.fragment,a),c(o),f=!0)},o(a){m(t.$$.fragment,a),m(o),f=!1},d(a){w(t,a),a&&g(n),a&&g(l),a&&g(r),o&&o.d(a),a&&g(i)}}}function G(s){let t,n,e=s[0].layerDef.filters,l=[];for(let i=0;i<e.length;i+=1)l[i]=Y(O(s,e,i));const r=i=>m(l[i],1,1,()=>{l[i]=null});return{c(){t=S("div");for(let i=0;i<l.length;i+=1)l[i].c();I(t,"id","subfilters"),I(t,"class","ml-4 flex flex-col gap-y-1")},m(i,f){d(i,t,f);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(t,null);n=!0},p(i,f){if(f&385){e=i[0].layerDef.filters;let o;for(o=0;o<e.length;o+=1){const a=O(i,e,o);l[o]?(l[o].p(a,f),c(l[o],1)):(l[o]=Y(a),l[o].c(),c(l[o],1),l[o].m(t,null))}for(b(),o=e.length;o<l.length;o+=1)r(o);$()}},i(i){if(!n){for(let f=0;f<e.length;f+=1)c(l[f]);n=!0}},o(i){l=l.filter(Boolean);for(let f=0;f<l.length;f+=1)m(l[f]);n=!1},d(i){i&&g(t),A(l,i)}}}function H(s){let t,n;return t=new le({props:{selected:s[7](s[13]),$$slots:{default:[De]},$$scope:{ctx:s}}}),{c(){k(t.$$.fragment)},m(e,l){v(t,e,l),n=!0},p(e,l){const r={};l&1&&(r.selected=e[7](e[13])),l&524289&&(r.$$scope={dirty:l,ctx:e}),t.$set(r)},i(e){n||(c(t.$$.fragment,e),n=!0)},o(e){m(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function De(s){let t=s[13].options[0].question+"",n;return{c(){n=q(t)},m(e,l){d(e,n,l)},p(e,l){l&1&&t!==(t=e[13].options[0].question+"")&&N(n,t)},d(e){e&&g(n)}}}function K(s){let t,n;return t=new ke({props:{id:s[13].id,filteredLayer:s[0],option:s[13].options[0]}}),{c(){k(t.$$.fragment)},m(e,l){v(t,e,l),n=!0},p(e,l){const r={};l&1&&(r.id=e[13].id),l&1&&(r.filteredLayer=e[0]),l&1&&(r.option=e[13].options[0]),t.$set(r)},i(e){n||(c(t.$$.fragment,e),n=!0)},o(e){m(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function M(s){let t,n;return t=new de({props:{value:s[8](s[13]),$$slots:{default:[Le]},$$scope:{ctx:s}}}),{c(){k(t.$$.fragment)},m(e,l){v(t,e,l),n=!0},p(e,l){const r={};l&1&&(r.value=e[8](e[13])),l&524289&&(r.$$scope={dirty:l,ctx:e}),t.$set(r)},i(e){n||(c(t.$$.fragment,e),n=!0)},o(e){m(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function X(s){let t,n=s[16].question+"",e,l;return{c(){t=S("option"),e=q(n),l=D(),t.__value=s[18],t.value=t.__value},m(r,i){d(r,t,i),L(t,e),L(t,l)},p(r,i){i&1&&n!==(n=r[16].question+"")&&N(e,n)},d(r){r&&g(t)}}}function Le(s){let t,n=s[13].options,e=[];for(let l=0;l<n.length;l+=1)e[l]=X(P(s,n,l));return{c(){for(let l=0;l<e.length;l+=1)e[l].c();t=C()},m(l,r){for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(l,r);d(l,t,r)},p(l,r){if(r&1){n=l[13].options;let i;for(i=0;i<n.length;i+=1){const f=P(l,n,i);e[i]?e[i].p(f,r):(e[i]=X(f),e[i].c(),e[i].m(t.parentNode,t))}for(;i<e.length;i+=1)e[i].d(1);e.length=n.length}},d(l){A(e,l),l&&g(t)}}}function Y(s){let t,n,e,l,r,i=s[13].options.length===1&&s[13].options[0].fields.length===0&&H(s),f=s[13].options.length===1&&s[13].options[0].fields.length>0&&K(s),o=s[13].options.length>1&&M(s);return{c(){t=S("div"),i&&i.c(),n=D(),f&&f.c(),e=D(),o&&o.c(),l=D()},m(a,u){d(a,t,u),i&&i.m(t,null),L(t,n),f&&f.m(t,null),L(t,e),o&&o.m(t,null),L(t,l),r=!0},p(a,u){a[13].options.length===1&&a[13].options[0].fields.length===0?i?(i.p(a,u),u&1&&c(i,1)):(i=H(a),i.c(),c(i,1),i.m(t,n)):i&&(b(),m(i,1,1,()=>{i=null}),$()),a[13].options.length===1&&a[13].options[0].fields.length>0?f?(f.p(a,u),u&1&&c(f,1)):(f=K(a),f.c(),c(f,1),f.m(t,e)):f&&(b(),m(f,1,1,()=>{f=null}),$()),a[13].options.length>1?o?(o.p(a,u),u&1&&c(o,1)):(o=M(a),o.c(),c(o,1),o.m(t,l)):o&&(b(),m(o,1,1,()=>{o=null}),$())},i(a){r||(c(i),c(f),c(o),r=!0)},o(a){m(i),m(f),m(o),r=!1},d(a){a&&g(t),i&&i.d(),f&&f.d(),o&&o.d()}}}function Se(s){let t,n,e=s[0].layerDef.name&&Q(s);return{c(){e&&e.c(),t=C()},m(l,r){e&&e.m(l,r),d(l,t,r),n=!0},p(l,[r]){l[0].layerDef.name?e?(e.p(l,r),r&1&&c(e,1)):(e=Q(l),e.c(),c(e,1),e.m(t.parentNode,t)):e&&(b(),m(e,1,1,()=>{e=null}),$())},i(l){n||(c(e),n=!0)},o(l){m(e),n=!1},d(l){e&&e.d(l),l&&g(t)}}}function ze(s,t,n){let e,l=F,r=()=>(l(),l=oe(a,p=>n(3,e=p)),a),i;s.$$.on_destroy.push(()=>l());let{filteredLayer:f}=t,{highlightedLayer:o=new R(void 0)}=t,{zoomlevel:a=new R(22)}=t;r();let u=f.layerDef,h=f.isDisplayed;ee(s,h,p=>n(4,i=p));function U(p){return f.appliedFilters.get(p.id).sync(z=>z===0,[],z=>z?0:void 0)}function B(p){return f.appliedFilters.get(p.id)}let _;const y=()=>{var p;return(p=u.defaultIcon())==null?void 0:p.SetClass("block h-6 w-6 no-image-background opacity-50")},T=()=>{var p;return(p=u.defaultIcon())==null?void 0:p.SetClass("block h-6 w-6 no-image-background")};function ie(p){re[p?"unshift":"push"](()=>{_=p,n(2,_)})}return s.$$set=p=>{"filteredLayer"in p&&n(0,f=p.filteredLayer),"highlightedLayer"in p&&n(9,o=p.highlightedLayer),"zoomlevel"in p&&r(n(1,a=p.zoomlevel))},s.$$.update=()=>{s.$$.dirty&517&&te(o.addCallbackAndRun(p=>{var V,z;p===f.layerDef.id?(V=_==null?void 0:_.classList)==null||V.add("glowing-shadow"):(z=_==null?void 0:_.classList)==null||z.remove("glowing-shadow")}))},[f,a,_,e,i,u,h,U,B,o,y,T,ie]}class Ve extends Z{constructor(t){super(),E(this,t,ze,Se,x,{filteredLayer:0,highlightedLayer:9,zoomlevel:1})}}export{Ve as F};
//# sourceMappingURL=Filterview-fa75ae0d.js.map
