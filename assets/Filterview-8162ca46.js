import{S as Y,i as Z,s as x,e as D,d as g,t as u,z as b,A as $,g as m,h as d,M as V,B as ee,I as ne,y as I,n as T,c as k,a as L,b as F,m as v,f as z,j as y,ab as ie,J as C,C as J}from"./index-c311521b.js";import{a as oe,U as re,I as j}from"./UIEventSource-295e38b5.js";import{L as fe,T as N,a as se}from"./tw-merge-40428302.js";import"./FixImages-fd04f50b.js";import"./Constants-33b474e2.js";import{F as ae,V as ue,T as ce}from"./ValidatedInput-91a56bd3.js";import{C as te}from"./Checkbox-f7df4274.js";import{D as me}from"./Dropdown-229f0a66.js";function A(s,t,i){const l=s.slice();return l[11]=t[i],l[13]=i,l}function _e(s){let t,i=s[11].message+"",l;return{c(){t=new ie(!1),l=I(),t.a=l},m(e,r){t.m(i,e,r),g(e,l,r)},p(e,r){r&1&&i!==(i=e[11].message+"")&&t.p(i)},i:T,o:T,d(e){e&&d(l),e&&t.d()}}}function pe(s){let t,i,l,e;return i=new ue({props:{value:s[1][s[11].subs],type:s[2][s[11].subs]}}),{c(){t=D("span"),k(i.$$.fragment),l=L(),F(t,"class","mx-1")},m(r,o){g(r,t,o),v(i,t,null),z(t,l),e=!0},p(r,o){const f={};o&3&&(f.value=r[1][r[11].subs]),o&5&&(f.type=r[2][r[11].subs]),i.$set(f)},i(r){e||(u(i.$$.fragment,r),e=!0)},o(r){m(i.$$.fragment,r),e=!1},d(r){r&&d(t),y(i)}}}function E(s){let t,i,l,e;const r=[pe,_e],o=[];function f(n,a){return n[11].subs?0:1}return t=f(s),i=o[t]=r[t](s),{c(){i.c(),l=I()},m(n,a){o[t].m(n,a),g(n,l,a),e=!0},p(n,a){let c=t;t=f(n),t===c?o[t].p(n,a):(b(),m(o[c],1,1,()=>{o[c]=null}),$(),i=o[t],i?i.p(n,a):(i=o[t]=r[t](n),i.c()),u(i,1),i.m(l.parentNode,l))},i(n){e||(u(i),e=!0)},o(n){m(i),e=!1},d(n){o[t].d(n),n&&d(l)}}}function ge(s){let t,i,l=s[0],e=[];for(let o=0;o<l.length;o+=1)e[o]=E(A(s,l,o));const r=o=>m(e[o],1,1,()=>{e[o]=null});return{c(){t=D("div");for(let o=0;o<e.length;o+=1)e[o].c()},m(o,f){g(o,t,f);for(let n=0;n<e.length;n+=1)e[n]&&e[n].m(t,null);i=!0},p(o,[f]){if(f&7){l=o[0];let n;for(n=0;n<l.length;n+=1){const a=A(o,l,n);e[n]?(e[n].p(a,f),u(e[n],1)):(e[n]=E(a),e[n].c(),u(e[n],1),e[n].m(t,null))}for(b(),n=l.length;n<e.length;n+=1)r(n);$()}},i(o){if(!i){for(let f=0;f<l.length;f+=1)u(e[f]);i=!0}},o(o){e=e.filter(Boolean);for(let f=0;f<e.length;f+=1)m(e[f]);i=!1},d(o){o&&d(t),V(e,o)}}}function de(s,t,i){let l,{filteredLayer:e}=t,{option:r}=t,{id:o}=t,f,n=fe.language;ee(s,n,_=>i(7,l=_));let a={},c={},h=e.appliedFilters.get(o),S=JSON.parse((h==null?void 0:h.data)??"{}");function q(){const _={};for(const w in a){const B=a[w].data;B===void 0?_[w]=void 0:_[w]=B}h==null||h.setData(ae.fieldsToString(_))}for(const _ of r.fields){const w=new oe(S[_.name]??"");c[_.name]=_.type,a[_.name]=w,ne(w.stabilized(200).addCallback(()=>{q()}))}return s.$$set=_=>{"filteredLayer"in _&&i(4,e=_.filteredLayer),"option"in _&&i(5,r=_.option),"id"in _&&i(6,o=_.id)},s.$$.update=()=>{if(s.$$.dirty&160){const _=r.question.textFor(l);i(0,f=re.splitIntoSubstitutionParts(_))}},[f,a,c,n,e,r,o,l]}class he extends Y{constructor(t){super(),Z(this,t,de,ge,x,{filteredLayer:4,option:5,id:6})}}function H(s,t,i){const l=s.slice();return l[11]=t[i],l}function M(s,t,i){const l=s.slice();return l[14]=t[i],l[16]=i,l}function O(s){var o;let t,i,l,e;i=new te({props:{selected:s[7],$$slots:{default:[be]},$$scope:{ctx:s}}});let r=s[4]&&((o=s[0].layerDef.filters)==null?void 0:o.length)>0&&W(s);return{c(){t=D("div"),k(i.$$.fragment),l=L(),r&&r.c(),F(t,"class","mb-1.5"),C(t,"focus",s[3]===s[0].layerDef.id)},m(f,n){g(f,t,n),v(i,t,null),z(t,l),r&&r.m(t,null),e=!0},p(f,n){var c;const a={};n&131121&&(a.$$scope={dirty:n,ctx:f}),i.$set(a),f[4]&&((c=f[0].layerDef.filters)==null?void 0:c.length)>0?r?(r.p(f,n),n&17&&u(r,1)):(r=W(f),r.c(),u(r,1),r.m(t,null)):r&&(b(),m(r,1,1,()=>{r=null}),$()),(!e||n&9)&&C(t,"focus",f[3]===f[0].layerDef.id)},i(f){e||(u(i.$$.fragment,f),u(r),e=!0)},o(f){m(i.$$.fragment,f),m(r),e=!1},d(f){f&&d(t),y(i),r&&r.d()}}}function P(s){let t,i,l;return i=new N({props:{t:se.t.general.layerSelection.zoomInToSeeThisLayer}}),{c(){t=D("span"),k(i.$$.fragment),F(t,"class","alert")},m(e,r){g(e,t,r),v(i,t,null),l=!0},p:T,i(e){l||(u(i.$$.fragment,e),l=!0)},o(e){m(i.$$.fragment,e),l=!1},d(e){e&&d(t),y(i)}}}function be(s){let t,i,l,e,r,o,f;i=new ce({props:{construct:s[10]}}),e=new N({props:{t:s[0].layerDef.name}});let n=s[5]<s[6].minzoom&&P();return{c(){t=D("div"),k(i.$$.fragment),l=L(),k(e.$$.fragment),r=L(),n&&n.c(),o=I(),F(t,"class","block h-6 w-6 no-image-background"),C(t,"opacity-50",!s[4])},m(a,c){g(a,t,c),v(i,t,null),g(a,l,c),v(e,a,c),g(a,r,c),n&&n.m(a,c),g(a,o,c),f=!0},p(a,c){(!f||c&16)&&C(t,"opacity-50",!a[4]);const h={};c&1&&(h.t=a[0].layerDef.name),e.$set(h),a[5]<a[6].minzoom?n?(n.p(a,c),c&32&&u(n,1)):(n=P(),n.c(),u(n,1),n.m(o.parentNode,o)):n&&(b(),m(n,1,1,()=>{n=null}),$())},i(a){f||(u(i.$$.fragment,a),u(e.$$.fragment,a),u(n),f=!0)},o(a){m(i.$$.fragment,a),m(e.$$.fragment,a),m(n),f=!1},d(a){a&&d(t),y(i),a&&d(l),y(e,a),a&&d(r),n&&n.d(a),a&&d(o)}}}function W(s){let t,i,l=s[0].layerDef.filters,e=[];for(let o=0;o<l.length;o+=1)e[o]=X(H(s,l,o));const r=o=>m(e[o],1,1,()=>{e[o]=null});return{c(){t=D("div");for(let o=0;o<e.length;o+=1)e[o].c();F(t,"id","subfilters"),F(t,"class","ml-4 flex flex-col gap-y-1")},m(o,f){g(o,t,f);for(let n=0;n<e.length;n+=1)e[n]&&e[n].m(t,null);i=!0},p(o,f){if(f&769){l=o[0].layerDef.filters;let n;for(n=0;n<l.length;n+=1){const a=H(o,l,n);e[n]?(e[n].p(a,f),u(e[n],1)):(e[n]=X(a),e[n].c(),u(e[n],1),e[n].m(t,null))}for(b(),n=l.length;n<e.length;n+=1)r(n);$()}},i(o){if(!i){for(let f=0;f<l.length;f+=1)u(e[f]);i=!0}},o(o){e=e.filter(Boolean);for(let f=0;f<e.length;f+=1)m(e[f]);i=!1},d(o){o&&d(t),V(e,o)}}}function G(s){let t,i;return t=new te({props:{selected:s[8](s[11]),$$slots:{default:[$e]},$$scope:{ctx:s}}}),{c(){k(t.$$.fragment)},m(l,e){v(t,l,e),i=!0},p(l,e){const r={};e&1&&(r.selected=l[8](l[11])),e&131073&&(r.$$scope={dirty:e,ctx:l}),t.$set(r)},i(l){i||(u(t.$$.fragment,l),i=!0)},o(l){m(t.$$.fragment,l),i=!1},d(l){y(t,l)}}}function $e(s){let t,i;return t=new N({props:{t:s[11].options[0].question}}),{c(){k(t.$$.fragment)},m(l,e){v(t,l,e),i=!0},p(l,e){const r={};e&1&&(r.t=l[11].options[0].question),t.$set(r)},i(l){i||(u(t.$$.fragment,l),i=!0)},o(l){m(t.$$.fragment,l),i=!1},d(l){y(t,l)}}}function K(s){let t,i;return t=new he({props:{id:s[11].id,filteredLayer:s[0],option:s[11].options[0]}}),{c(){k(t.$$.fragment)},m(l,e){v(t,l,e),i=!0},p(l,e){const r={};e&1&&(r.id=l[11].id),e&1&&(r.filteredLayer=l[0]),e&1&&(r.option=l[11].options[0]),t.$set(r)},i(l){i||(u(t.$$.fragment,l),i=!0)},o(l){m(t.$$.fragment,l),i=!1},d(l){y(t,l)}}}function Q(s){let t,i;return t=new me({props:{value:s[9](s[11]),$$slots:{default:[ke]},$$scope:{ctx:s}}}),{c(){k(t.$$.fragment)},m(l,e){v(t,l,e),i=!0},p(l,e){const r={};e&1&&(r.value=l[9](l[11])),e&131073&&(r.$$scope={dirty:e,ctx:l}),t.$set(r)},i(l){i||(u(t.$$.fragment,l),i=!0)},o(l){m(t.$$.fragment,l),i=!1},d(l){y(t,l)}}}function R(s){let t,i,l,e;return i=new N({props:{t:s[14].question}}),{c(){t=D("option"),k(i.$$.fragment),l=L(),t.__value=s[16],t.value=t.__value},m(r,o){g(r,t,o),v(i,t,null),z(t,l),e=!0},p(r,o){const f={};o&1&&(f.t=r[14].question),i.$set(f)},i(r){e||(u(i.$$.fragment,r),e=!0)},o(r){m(i.$$.fragment,r),e=!1},d(r){r&&d(t),y(i)}}}function ke(s){let t,i,l=s[11].options,e=[];for(let o=0;o<l.length;o+=1)e[o]=R(M(s,l,o));const r=o=>m(e[o],1,1,()=>{e[o]=null});return{c(){for(let o=0;o<e.length;o+=1)e[o].c();t=I()},m(o,f){for(let n=0;n<e.length;n+=1)e[n]&&e[n].m(o,f);g(o,t,f),i=!0},p(o,f){if(f&1){l=o[11].options;let n;for(n=0;n<l.length;n+=1){const a=M(o,l,n);e[n]?(e[n].p(a,f),u(e[n],1)):(e[n]=R(a),e[n].c(),u(e[n],1),e[n].m(t.parentNode,t))}for(b(),n=l.length;n<e.length;n+=1)r(n);$()}},i(o){if(!i){for(let f=0;f<l.length;f+=1)u(e[f]);i=!0}},o(o){e=e.filter(Boolean);for(let f=0;f<e.length;f+=1)m(e[f]);i=!1},d(o){V(e,o),o&&d(t)}}}function X(s){let t,i,l,e,r,o=s[11].options.length===1&&s[11].options[0].fields.length===0&&G(s),f=s[11].options.length===1&&s[11].options[0].fields.length>0&&K(s),n=s[11].options.length>1&&Q(s);return{c(){t=D("div"),o&&o.c(),i=L(),f&&f.c(),l=L(),n&&n.c(),e=L()},m(a,c){g(a,t,c),o&&o.m(t,null),z(t,i),f&&f.m(t,null),z(t,l),n&&n.m(t,null),z(t,e),r=!0},p(a,c){a[11].options.length===1&&a[11].options[0].fields.length===0?o?(o.p(a,c),c&1&&u(o,1)):(o=G(a),o.c(),u(o,1),o.m(t,i)):o&&(b(),m(o,1,1,()=>{o=null}),$()),a[11].options.length===1&&a[11].options[0].fields.length>0?f?(f.p(a,c),c&1&&u(f,1)):(f=K(a),f.c(),u(f,1),f.m(t,l)):f&&(b(),m(f,1,1,()=>{f=null}),$()),a[11].options.length>1?n?(n.p(a,c),c&1&&u(n,1)):(n=Q(a),n.c(),u(n,1),n.m(t,e)):n&&(b(),m(n,1,1,()=>{n=null}),$())},i(a){r||(u(o),u(f),u(n),r=!0)},o(a){m(o),m(f),m(n),r=!1},d(a){a&&d(t),o&&o.d(),f&&f.d(),n&&n.d()}}}function ve(s){let t,i,l=s[0].layerDef.name&&O(s);return{c(){l&&l.c(),t=I()},m(e,r){l&&l.m(e,r),g(e,t,r),i=!0},p(e,[r]){e[0].layerDef.name?l?(l.p(e,r),r&1&&u(l,1)):(l=O(e),l.c(),u(l,1),l.m(t.parentNode,t)):l&&(b(),m(l,1,1,()=>{l=null}),$())},i(e){i||(u(l),i=!0)},o(e){m(l),i=!1},d(e){l&&l.d(e),e&&d(t)}}}function ye(s,t,i){let l,e=T,r=()=>(e(),e=J(h,p=>i(3,l=p)),h),o,f,n=T,a=()=>(n(),n=J(S,p=>i(5,f=p)),S);s.$$.on_destroy.push(()=>e()),s.$$.on_destroy.push(()=>n());let{filteredLayer:c}=t,{highlightedLayer:h=new j(void 0)}=t;r();let{zoomlevel:S=new j(22)}=t;a();let q=c.layerDef,_=c.isDisplayed;ee(s,_,p=>i(4,o=p));function w(p){return c.appliedFilters.get(p.id).sync(U=>U===0,[],U=>U?0:void 0)}function B(p){return c.appliedFilters.get(p.id)}const le=()=>q.defaultIcon();return s.$$set=p=>{"filteredLayer"in p&&i(0,c=p.filteredLayer),"highlightedLayer"in p&&r(i(1,h=p.highlightedLayer)),"zoomlevel"in p&&a(i(2,S=p.zoomlevel))},[c,h,S,l,o,f,q,_,w,B,le]}class Be extends Y{constructor(t){super(),Z(this,t,ye,ve,x,{filteredLayer:0,highlightedLayer:1,zoomlevel:2})}}export{Be as F};
//# sourceMappingURL=Filterview-8162ca46.js.map
