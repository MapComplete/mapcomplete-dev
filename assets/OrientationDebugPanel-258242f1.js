var X=Object.defineProperty;var Y=(s,e,t)=>e in s?X(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var I=(s,e,t)=>(Y(s,typeof e!="symbol"?e+"":e,t),t);import{S as J,i as K,s as Q,A as V,d as B,t as E,C as Z,g as N,D as x,h as C,E as S,e as k,R as h,a as P,c as F,b as G,f as l,m as O,T as y,j as R,n as U}from"./Svg-fa18a5ae.js";import{U as T,S as $,I as W}from"./LocalStorageSource-046df3bc.js";import{T as ee,a as te}from"./Tr-b3effab6.js";import{G as ae}from"./GeoOperations-850bc673.js";import{I as se}from"./If-2c8fbb93.js";const L=class L{constructor(){I(this,"gotMeasurement",new T(!1));I(this,"alpha",new T(void 0));I(this,"beta",new T(void 0));I(this,"gamma",new T(void 0));I(this,"absolute",new T(void 0));I(this,"arrowDirection",new T(void 0));I(this,"_measurementsStarted",!1)}fakeMeasurements(e=!0){console.log("Starting fake measurements of orientation sensors",{alpha:this.alpha,beta:this.beta,gamma:this.gamma,absolute:this.absolute}),this.alpha.setData(45),e&&$.Chronic(25).addCallback(t=>this.alpha.setData(-(t.getTime()/10)%360)),this.beta.setData(20),this.gamma.setData(30),this.absolute.setData(!0),this.gotMeasurement.setData(!0)}startMeasurements(){if(!this._measurementsStarted){this._measurementsStarted=!0,console.log("Starting device orientation listener");try{window.addEventListener("deviceorientationabsolute",e=>this.update(e))}catch(e){console.log("Could not init device orientation api due to",e)}}}update(e){this.gotMeasurement.setData(!0),this.alpha.setData(Math.floor(360-e.alpha)),this.beta.setData(Math.floor(e.beta)),this.gamma.setData(Math.floor(e.gamma)),this.absolute.setData(e.absolute),this.beta.data<0?this.arrowDirection.setData(this.gamma.data+180):this.arrowDirection.setData(-this.gamma.data)}};I(L,"singleton",new L);let j=L;function z(s){var M;let e,t,a,n,o,p,_,m,v,g,c,f,i,r;return c=new ee({props:{t:te.t.validation.slope.inputExplanation}}),i=new se({props:{condition:((M=s[0])==null?void 0:M.featureSwitchIsTesting)??new W(!0),$$slots:{default:[le]},$$scope:{ctx:s}}}),{c(){e=k("div"),t=k("div"),a=k("div"),n=k("div"),o=h(s[3]),p=P(),_=k("div"),m=h(s[4]),v=P(),g=k("div"),F(c.$$.fragment),f=P(),F(i.$$.fragment),G(a,"class","font-bold w-full flex justify-around items-center text-5xl"),G(t,"class","flex w-full"),G(e,"class","flex flex-col m-2")},m(d,D){B(d,e,D),l(e,t),l(t,a),l(a,n),l(n,o),l(a,p),l(a,_),l(_,m),l(e,v),l(e,g),O(c,g,null),l(e,f),O(i,e,null),r=!0},p(d,D){var w;(!r||D&8)&&y(o,d[3]),(!r||D&16)&&y(m,d[4]);const b={};D&1&&(b.condition=((w=d[0])==null?void 0:w.featureSwitchIsTesting)??new W(!0)),D&131170&&(b.$$scope={dirty:D,ctx:d}),i.$set(b)},i(d){r||(E(c.$$.fragment,d),E(i.$$.fragment,d),r=!0)},o(d){N(c.$$.fragment,d),N(i.$$.fragment,d),r=!1},d(d){d&&C(e),R(c),R(i)}}}function ne(s){let e;return{c(){e=h("Backward")},m(t,a){B(t,e,a)},d(t){t&&C(e)}}}function oe(s){let e;return{c(){e=h("Forward")},m(t,a){B(t,e,a)},d(t){t&&C(e)}}}function le(s){let e,t,a,n,o,p,_=s[1]-s[5]+"",m,v;function g(i,r){return i[6]===1?oe:ne}let c=g(s),f=c(s);return{c(){e=k("span"),t=h("Way: "),a=h(s[1]),n=h("째, compass: "),o=h(s[5]),p=h("째, diff: "),m=h(_),v=P(),f.c(),G(e,"class","subtle")},m(i,r){B(i,e,r),l(e,t),l(e,a),l(e,n),l(e,o),l(e,p),l(e,m),l(e,v),f.m(e,null)},p(i,r){r&2&&y(a,i[1]),r&32&&y(o,i[5]),r&34&&_!==(_=i[1]-i[5]+"")&&y(m,_),c!==(c=g(i))&&(f.d(1),f=c(i),f&&(f.c(),f.m(e,null)))},d(i){i&&C(e),f.d()}}}function ie(s){let e,t,a=s[2]&&z(s);return{c(){a&&a.c(),e=V()},m(n,o){a&&a.m(n,o),B(n,e,o),t=!0},p(n,[o]){n[2]?a?(a.p(n,o),o&4&&E(a,1)):(a=z(n),a.c(),E(a,1),a.m(e.parentNode,e)):a&&(Z(),N(a,1,1,()=>{a=null}),x())},i(n){t||(E(a),t=!0)},o(n){N(a),t=!1},d(n){a&&a.d(n),n&&C(e)}}}function H(s){const e=Math.tan(s*Math.PI/180)*100;return Math.round(e/2.5)*2.5+"%"}function re(s,e,t){var q;let a,n,o,p,_,{value:m=new T(void 0)}=e,{mode:v="percentage"}=e,{feature:g=void 0}=e,{state:c=void 0}=e,f=45;((q=g==null?void 0:g.geometry)==null?void 0:q.type)==="LineString"&&(f=Math.round(ae.bearing(g.geometry.coordinates[0],g.geometry.coordinates.at(-1))));let i=new T(void 0);S(s,i,u=>t(3,n=u));let r=new T(void 0);S(s,r,u=>t(4,o=u));const M=j.singleton;M.startMeasurements();const d=M.alpha;S(s,d,u=>t(5,p=u));const D=M.beta;let b=M.gotMeasurement;S(s,b,u=>t(2,a=u));let w=d.map(u=>{if(f===void 0)return 1;f<0&&t(1,f+=360);let A=Math.abs(f-u)%360;return A<90||A>270?1:-1});return S(s,w,u=>t(6,_=u)),D.map(u=>{let A=w.data;v==="degrees"?m.setData(A*u+"째"):m.setData(H(A*u)),i.setData(u+"째"),r.setData(H(u))},[w,D]),s.$$set=u=>{"value"in u&&t(12,m=u.value),"mode"in u&&t(13,v=u.mode),"feature"in u&&t(14,g=u.feature),"state"in u&&t(0,c=u.state)},[c,f,a,n,o,p,_,i,r,d,b,w,m,v,g]}class ve extends J{constructor(e){super(),K(this,e,re,ie,Q,{value:12,mode:13,feature:14,state:0})}}function ue(s){let e,t,a,n,o,p,_,m,v,g,c,f,i,r,M,d,D;return{c(){e=h(`Device orientation data:
  `),t=k("ol"),a=k("li"),n=h("Alpha: "),o=h(s[1]),p=P(),_=k("li"),m=h("Beta: "),v=h(s[2]),g=P(),c=k("li"),f=h("Gamma: "),i=h(s[3]),r=P(),M=k("li"),d=h("Absolute?: "),D=h(s[4])},m(b,w){B(b,e,w),B(b,t,w),l(t,a),l(a,n),l(a,o),l(t,p),l(t,_),l(_,m),l(_,v),l(t,g),l(t,c),l(c,f),l(c,i),l(t,r),l(t,M),l(M,d),l(M,D)},p(b,w){w&2&&y(o,b[1]),w&4&&y(v,b[2]),w&8&&y(i,b[3]),w&16&&y(D,b[4])},d(b){b&&C(e),b&&C(t)}}}function fe(s){let e;return{c(){e=h("No device orientation data available")},m(t,a){B(t,e,a)},p:U,d(t){t&&C(e)}}}function me(s){let e;function t(o,p){return o[0]?ue:fe}let a=t(s),n=a(s);return{c(){n.c(),e=V()},m(o,p){n.m(o,p),B(o,e,p)},p(o,[p]){a===(a=t(o))&&n?n.p(o,p):(n.d(1),n=a(o),n&&(n.c(),n.m(e.parentNode,e)))},i:U,o:U,d(o){n.d(o),o&&C(e)}}}function ce(s,e,t){let a,n,o,p,_;const m=j.singleton;let v=m.alpha;S(s,v,r=>t(1,n=r));let g=m.beta;S(s,g,r=>t(2,o=r));let c=m.gamma;S(s,c,r=>t(3,p=r));let f=m.absolute;S(s,f,r=>t(4,_=r));let i=m.gotMeasurement;return S(s,i,r=>t(0,a=r)),m.startMeasurements(),[a,n,o,p,_,v,g,c,f,i]}class we extends J{constructor(e){super(),K(this,e,ce,me,Q,{})}}export{j as O,ve as S,we as a};
