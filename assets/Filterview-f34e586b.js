import{S as X,i as Z,s as x,e as S,d,t as u,z as v,A as y,g as c,h,L as U,B as ee,I as ie,y as C,n as D,c as $,a as L,b as T,m as b,f as I,j as k,ab as re,Y as V,C as j}from"./index-747a309a.js";import{a as se,U as fe,I as A}from"./UIEventSource-e47c8002.js";import{L as ae,T as B,a as ue}from"./tw-merge-ea924f16.js";import"./FixImages-3d450d68.js";import"./Constants-89143ec9.js";import{F as ce,V as me,C as te,I as _e,T as le}from"./Checkbox-9ecbc2cc.js";import{D as pe}from"./Dropdown-e7469e3e.js";function E(f,e,o){const t=f.slice();return t[11]=e[o],t[13]=o,t}function ge(f){let e,o=f[11].message+"",t;return{c(){e=new re(!1),t=C(),e.a=t},m(l,s){e.m(o,l,s),d(l,t,s)},p(l,s){s&1&&o!==(o=l[11].message+"")&&e.p(o)},i:D,o:D,d(l){l&&h(t),l&&e.d()}}}function de(f){let e,o,t,l;return o=new me({props:{value:f[1][f[11].subs],type:f[2][f[11].subs]}}),{c(){e=S("span"),$(o.$$.fragment),t=L(),T(e,"class","mx-1")},m(s,i){d(s,e,i),b(o,e,null),I(e,t),l=!0},p(s,i){const r={};i&3&&(r.value=s[1][s[11].subs]),i&5&&(r.type=s[2][s[11].subs]),o.$set(r)},i(s){l||(u(o.$$.fragment,s),l=!0)},o(s){c(o.$$.fragment,s),l=!1},d(s){s&&h(e),k(o)}}}function H(f){let e,o,t,l;const s=[de,ge],i=[];function r(n,a){return n[11].subs?0:1}return e=r(f),o=i[e]=s[e](f),{c(){o.c(),t=C()},m(n,a){i[e].m(n,a),d(n,t,a),l=!0},p(n,a){let m=e;e=r(n),e===m?i[e].p(n,a):(v(),c(i[m],1,1,()=>{i[m]=null}),y(),o=i[e],o?o.p(n,a):(o=i[e]=s[e](n),o.c()),u(o,1),o.m(t.parentNode,t))},i(n){l||(u(o),l=!0)},o(n){c(o),l=!1},d(n){i[e].d(n),n&&h(t)}}}function he(f){let e,o,t=f[0],l=[];for(let i=0;i<t.length;i+=1)l[i]=H(E(f,t,i));const s=i=>c(l[i],1,1,()=>{l[i]=null});return{c(){e=S("div");for(let i=0;i<l.length;i+=1)l[i].c()},m(i,r){d(i,e,r);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null);o=!0},p(i,[r]){if(r&7){t=i[0];let n;for(n=0;n<t.length;n+=1){const a=E(i,t,n);l[n]?(l[n].p(a,r),u(l[n],1)):(l[n]=H(a),l[n].c(),u(l[n],1),l[n].m(e,null))}for(v(),n=t.length;n<l.length;n+=1)s(n);y()}},i(i){if(!o){for(let r=0;r<t.length;r+=1)u(l[r]);o=!0}},o(i){l=l.filter(Boolean);for(let r=0;r<l.length;r+=1)c(l[r]);o=!1},d(i){i&&h(e),U(l,i)}}}function $e(f,e,o){let t,{filteredLayer:l}=e,{option:s}=e,{id:i}=e,r,n=ae.language;ee(f,n,_=>o(7,t=_));let a={},m={},g=l.appliedFilters.get(i),z=JSON.parse((g==null?void 0:g.data)??"{}");function F(){const _={};for(const w in a){const q=a[w].data;q===void 0?_[w]=void 0:_[w]=q}g==null||g.setData(ce.fieldsToString(_))}for(const _ of s.fields){const w=new se(z[_.name]??"");m[_.name]=_.type,a[_.name]=w,ie(w.stabilized(200).addCallback(()=>{F()}))}return f.$$set=_=>{"filteredLayer"in _&&o(4,l=_.filteredLayer),"option"in _&&o(5,s=_.option),"id"in _&&o(6,i=_.id)},f.$$.update=()=>{if(f.$$.dirty&160){const _=s.question.textFor(t);o(0,r=fe.splitIntoSubstitutionParts(_))}},[r,a,m,n,l,s,i,t]}class be extends X{constructor(e){super(),Z(this,e,$e,he,x,{filteredLayer:4,option:5,id:6})}}function J(f,e,o){const t=f.slice();return t[12]=e[o],t}function O(f,e,o){const t=f.slice();return t[15]=e[o],t[17]=o,t}function P(f){var i;let e,o,t,l;o=new te({props:{selected:f[7],$$slots:{default:[ye]},$$scope:{ctx:f}}});let s=f[5]&&((i=f[0].layerDef.filters)==null?void 0:i.length)>0&&Y(f);return{c(){e=S("div"),$(o.$$.fragment),t=L(),s&&s.c(),T(e,"class","mb-1.5"),V(e,"focus",f[3]===f[0].layerDef.id)},m(r,n){d(r,e,n),b(o,e,null),I(e,t),s&&s.m(e,null),l=!0},p(r,n){var m;const a={};n&262161&&(a.$$scope={dirty:n,ctx:r}),o.$set(a),r[5]&&((m=r[0].layerDef.filters)==null?void 0:m.length)>0?s?(s.p(r,n),n&33&&u(s,1)):(s=Y(r),s.c(),u(s,1),s.m(e,null)):s&&(v(),c(s,1,1,()=>{s=null}),y()),(!l||n&9)&&V(e,"focus",r[3]===r[0].layerDef.id)},i(r){l||(u(o.$$.fragment,r),u(s),l=!0)},o(r){c(o.$$.fragment,r),c(s),l=!1},d(r){r&&h(e),k(o),s&&s.d()}}}function ke(f){let e,o;return e=new le({props:{construct:f[11]}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p:D,i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function ve(f){let e,o;return e=new le({props:{slot:"else",construct:f[10]}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p:D,i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function W(f){let e,o,t;return o=new B({props:{t:ue.t.general.layerSelection.zoomInToSeeThisLayer}}),{c(){e=S("span"),$(o.$$.fragment),T(e,"class","alert")},m(l,s){d(l,e,s),b(o,e,null),t=!0},p:D,i(l){t||(u(o.$$.fragment,l),t=!0)},o(l){c(o.$$.fragment,l),t=!1},d(l){l&&h(e),k(o)}}}function ye(f){let e,o,t,l,s,i;e=new _e({props:{condition:f[0].isDisplayed,$$slots:{else:[ve],default:[ke]},$$scope:{ctx:f}}}),t=new B({props:{t:f[0].layerDef.name}});let r=f[4]<f[6].minzoom&&W();return{c(){$(e.$$.fragment),o=L(),$(t.$$.fragment),l=L(),r&&r.c(),s=C()},m(n,a){b(e,n,a),d(n,o,a),b(t,n,a),d(n,l,a),r&&r.m(n,a),d(n,s,a),i=!0},p(n,a){const m={};a&1&&(m.condition=n[0].isDisplayed),a&262144&&(m.$$scope={dirty:a,ctx:n}),e.$set(m);const g={};a&1&&(g.t=n[0].layerDef.name),t.$set(g),n[4]<n[6].minzoom?r?(r.p(n,a),a&16&&u(r,1)):(r=W(),r.c(),u(r,1),r.m(s.parentNode,s)):r&&(v(),c(r,1,1,()=>{r=null}),y())},i(n){i||(u(e.$$.fragment,n),u(t.$$.fragment,n),u(r),i=!0)},o(n){c(e.$$.fragment,n),c(t.$$.fragment,n),c(r),i=!1},d(n){k(e,n),n&&h(o),k(t,n),n&&h(l),r&&r.d(n),n&&h(s)}}}function Y(f){let e,o,t=f[0].layerDef.filters,l=[];for(let i=0;i<t.length;i+=1)l[i]=R(J(f,t,i));const s=i=>c(l[i],1,1,()=>{l[i]=null});return{c(){e=S("div");for(let i=0;i<l.length;i+=1)l[i].c();T(e,"id","subfilters"),T(e,"class","ml-4 flex flex-col gap-y-1")},m(i,r){d(i,e,r);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null);o=!0},p(i,r){if(r&769){t=i[0].layerDef.filters;let n;for(n=0;n<t.length;n+=1){const a=J(i,t,n);l[n]?(l[n].p(a,r),u(l[n],1)):(l[n]=R(a),l[n].c(),u(l[n],1),l[n].m(e,null))}for(v(),n=t.length;n<l.length;n+=1)s(n);y()}},i(i){if(!o){for(let r=0;r<t.length;r+=1)u(l[r]);o=!0}},o(i){l=l.filter(Boolean);for(let r=0;r<l.length;r+=1)c(l[r]);o=!1},d(i){i&&h(e),U(l,i)}}}function G(f){let e,o;return e=new te({props:{selected:f[8](f[12]),$$slots:{default:[we]},$$scope:{ctx:f}}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p(t,l){const s={};l&1&&(s.selected=t[8](t[12])),l&262145&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function we(f){let e,o;return e=new B({props:{t:f[12].options[0].question}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p(t,l){const s={};l&1&&(s.t=t[12].options[0].question),e.$set(s)},i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function K(f){let e,o;return e=new be({props:{id:f[12].id,filteredLayer:f[0],option:f[12].options[0]}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p(t,l){const s={};l&1&&(s.id=t[12].id),l&1&&(s.filteredLayer=t[0]),l&1&&(s.option=t[12].options[0]),e.$set(s)},i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function M(f){let e,o;return e=new pe({props:{value:f[9](f[12]),$$slots:{default:[Le]},$$scope:{ctx:f}}}),{c(){$(e.$$.fragment)},m(t,l){b(e,t,l),o=!0},p(t,l){const s={};l&1&&(s.value=t[9](t[12])),l&262145&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){o||(u(e.$$.fragment,t),o=!0)},o(t){c(e.$$.fragment,t),o=!1},d(t){k(e,t)}}}function Q(f){let e,o,t,l;return o=new B({props:{t:f[15].question}}),{c(){e=S("option"),$(o.$$.fragment),t=L(),e.__value=f[17],e.value=e.__value},m(s,i){d(s,e,i),b(o,e,null),I(e,t),l=!0},p(s,i){const r={};i&1&&(r.t=s[15].question),o.$set(r)},i(s){l||(u(o.$$.fragment,s),l=!0)},o(s){c(o.$$.fragment,s),l=!1},d(s){s&&h(e),k(o)}}}function Le(f){let e,o,t=f[12].options,l=[];for(let i=0;i<t.length;i+=1)l[i]=Q(O(f,t,i));const s=i=>c(l[i],1,1,()=>{l[i]=null});return{c(){for(let i=0;i<l.length;i+=1)l[i].c();e=C()},m(i,r){for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(i,r);d(i,e,r),o=!0},p(i,r){if(r&1){t=i[12].options;let n;for(n=0;n<t.length;n+=1){const a=O(i,t,n);l[n]?(l[n].p(a,r),u(l[n],1)):(l[n]=Q(a),l[n].c(),u(l[n],1),l[n].m(e.parentNode,e))}for(v(),n=t.length;n<l.length;n+=1)s(n);y()}},i(i){if(!o){for(let r=0;r<t.length;r+=1)u(l[r]);o=!0}},o(i){l=l.filter(Boolean);for(let r=0;r<l.length;r+=1)c(l[r]);o=!1},d(i){U(l,i),i&&h(e)}}}function R(f){let e,o,t,l,s,i=f[12].options.length===1&&f[12].options[0].fields.length===0&&G(f),r=f[12].options.length===1&&f[12].options[0].fields.length>0&&K(f),n=f[12].options.length>1&&M(f);return{c(){e=S("div"),i&&i.c(),o=L(),r&&r.c(),t=L(),n&&n.c(),l=L()},m(a,m){d(a,e,m),i&&i.m(e,null),I(e,o),r&&r.m(e,null),I(e,t),n&&n.m(e,null),I(e,l),s=!0},p(a,m){a[12].options.length===1&&a[12].options[0].fields.length===0?i?(i.p(a,m),m&1&&u(i,1)):(i=G(a),i.c(),u(i,1),i.m(e,o)):i&&(v(),c(i,1,1,()=>{i=null}),y()),a[12].options.length===1&&a[12].options[0].fields.length>0?r?(r.p(a,m),m&1&&u(r,1)):(r=K(a),r.c(),u(r,1),r.m(e,t)):r&&(v(),c(r,1,1,()=>{r=null}),y()),a[12].options.length>1?n?(n.p(a,m),m&1&&u(n,1)):(n=M(a),n.c(),u(n,1),n.m(e,l)):n&&(v(),c(n,1,1,()=>{n=null}),y())},i(a){s||(u(i),u(r),u(n),s=!0)},o(a){c(i),c(r),c(n),s=!1},d(a){a&&h(e),i&&i.d(),r&&r.d(),n&&n.d()}}}function De(f){let e,o,t=f[0].layerDef.name&&P(f);return{c(){t&&t.c(),e=C()},m(l,s){t&&t.m(l,s),d(l,e,s),o=!0},p(l,[s]){l[0].layerDef.name?t?(t.p(l,s),s&1&&u(t,1)):(t=P(l),t.c(),u(t,1),t.m(e.parentNode,e)):t&&(v(),c(t,1,1,()=>{t=null}),y())},i(l){o||(u(t),o=!0)},o(l){c(t),o=!1},d(l){t&&t.d(l),l&&h(e)}}}function Se(f,e,o){let t,l=D,s=()=>(l(),l=j(g,p=>o(3,t=p)),g),i,r=D,n=()=>(r(),r=j(z,p=>o(4,i=p)),z),a;f.$$.on_destroy.push(()=>l()),f.$$.on_destroy.push(()=>r());let{filteredLayer:m}=e,{highlightedLayer:g=new A(void 0)}=e;s();let{zoomlevel:z=new A(22)}=e;n();let F=m.layerDef,_=m.isDisplayed;ee(f,_,p=>o(5,a=p));function w(p){return m.appliedFilters.get(p.id).sync(N=>N===0,[],N=>N?0:void 0)}function q(p){return m.appliedFilters.get(p.id)}const ne=()=>{var p;return(p=F.defaultIcon())==null?void 0:p.SetClass("block h-6 w-6 no-image-background opacity-50")},oe=()=>{var p;return(p=F.defaultIcon())==null?void 0:p.SetClass("block h-6 w-6 no-image-background")};return f.$$set=p=>{"filteredLayer"in p&&o(0,m=p.filteredLayer),"highlightedLayer"in p&&s(o(1,g=p.highlightedLayer)),"zoomlevel"in p&&n(o(2,z=p.zoomlevel))},[m,g,z,t,i,a,F,_,w,q,ne,oe]}class Ue extends X{constructor(e){super(),Z(this,e,Se,De,x,{filteredLayer:0,highlightedLayer:1,zoomlevel:2})}}export{Ue as F};
//# sourceMappingURL=Filterview-f34e586b.js.map
